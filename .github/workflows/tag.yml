name: Manual Deploy by Tag
run-name: Deploy [${{ github.event.inputs.environment }}] by tag ${{ github.event.inputs.tag }}

on:
  workflow_dispatch:
    inputs:
      environment:
        description: "Select target environment"
        required: true
        type: choice
        options:
          - uat
          - prod
      tag:
        description: "Git tag to deploy (e.g. v1.0.3)"
        required: true
        type: string

jobs:
  deploy:
    runs-on: ubuntu-latest
    # Automatically links to the selected GitHub Environment
    environment: ${{ github.event.inputs.environment }}

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.inputs.tag }}

      - name: Display info
        run: |
          echo "Deploying tag: ${{ github.event.inputs.tag }}"
          echo "Target environment: ${{ github.event.inputs.environment }}"

      - name: Show environment variable from GitHub Environment
        run: |
          echo "ENV_NAME for ${{ github.event.inputs.environment }}: ${{ vars.ENV_NAME }}"

      - name: Deploy
        run: |
          if [ "${{ github.event.inputs.environment }}" = "uat" ]; then
            echo "âœ… Deploying to UAT..."
            # your UAT deploy logic here
          elif [ "${{ github.event.inputs.environment }}" = "prod" ]; then
            echo "ðŸš€ Deploying to PRODUCTION..."
            # your PROD deploy logic here
          fi
